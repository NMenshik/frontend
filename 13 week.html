<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Чат</title>
    <style>
      .heading {
        font-weight: 700;
        color: rgb(88, 88, 247);
        font-size: larger;
      }
      .name,
      .avatar-link {
        height: 32px;
        width: 249px;
      }
      .comment-section {
        height: 32px;
        width: 249px;
        margin-bottom: 5px;
      }
      #sbm-btn {
        height: 43px;
        width: 164px;
        background-color: rgb(53, 210, 238);
        border-radius: 10px;
        border-style: none;
      }

      .bold-font {
        font-weight: bold;
      }

      .input-comment {
        width: 300px;
        margin-right: 79px;
      }

      #avatar-img {
        width: 20%;
        height: 35%;
        margin-right: 10px;
      }

      body,
      #name-plus-img {
        display: flex;
        flex-direction: row;
      }

      #userName {
        font-weight: 700;
        color: rgb(88, 88, 247);
      }

      #show-name {
        margin-top: 9px;
        margin-bottom: 9px;
      }
    </style>
  </head>
  <body>
    <form id="commentForm">
    <div class="input-comment">
      <div class="heading">Оставьте ваш комментарий</div>
      <form id="show-name">
        <label for="radio">Показывать ваше имя?</label>
        <input type="radio" checked="checked" id="checkYes" name="radio" /> Да
        <input type="radio" id="checkNo" name="radio" onclick="showName()" />
        Нет
      </form>
      <div id="name-input">
        <div>Введите ваше <span class="bold-font">имя</span></div>
        <input class="name" type="text" />
      </div>
      <div>Вставьте ссылку <span class="bold-font">вашего аватара</span></div>
      <input class="avatar-link" type="url" />
      <div>Оставьте комментарий</div>
      <input class="comment-section" type="text" />
      <div>
        <button type="submit" id="sbm-btn" >
          Отправить
        </button>
      </div>
    </div>
    </form>
    <div class="output-comment">
      <div class="heading">Чат</div>

      <div id="name-plus-img">
       <div id="avatar-img"> </div>
        <div id="userName"></div>
        <div id="sbm-time"></div>
      </div>
      <div id="edited-comment"></div>
    </div>

    <script>
      //Берем элементы из разметки
      const commentForm = document.querySelector("#commentForm");
      const avatarLinkInput = document.querySelector(".avatar-link");
      const userNameInput = document.querySelector(".name");
      const commentSection = document.querySelector(".comment-section");
      const avatarImg = document.querySelector("#avatar-img");
      const userNameElement = document.querySelector("#userName");
      const editedCommentElement = document.querySelector("#edited-comment");

      //Функция для показа поля ввода имени, если выбран вариант да
      document.querySelector('#checkYes').addEventListener('click', (showInput)=> {
        document.getElementById("name-input").style.display = "block";
      });

      //Функция для скрытия поля ввода имени, если выбран вариант нет 
      document.querySelector('#checkNo').addEventListener('click', (hideInput)=> {
        document.getElementById("name-input").style.display = "none";
      });

      //Функция для обработки отправки комментария
      function commentOutput(e) {
        e.preventDefault(); //Предотвращаем перезагрузку страницы по умолчанию

        //Получаем значение полей из ввода

        let avatarLink = avatarLinkInput.value;
        let userName = userNameInput.value;
        let comment = commentSection.value;

        //Разделяем имя на отдельные слова
        let nameParts = userName.split(" ");

        //Преобразуем каждое слово так, чтобы оно начиналось с заглавной буквы, а остальные были строчные
        let finalNameParts = nameParts.map((word) => {
          return word.charAt(0).toUpperCase() + word.slice(1).toLowerCase();
        });

        //Объединяем слова обратно с правильным имененм пользователя
        let finalRightUserName = finalNameParts.join(" ");

        //Заменяем запрещенные слова
        const wordReplace = comment.replace(/viagra|XXX/gi, "***");

        //Устанавливаем текст элемента для имени пользователя
        userNameElement.textContent = finalRightUserName;

        //Попытка добавить тег img через appendChild
        //const image = document.createElement('img');
       // image.src = avatarLinkInput;
        //avatarImg.appendChild(image);
        

        //Добавляем тег img в div
        console.log(avatarImg.innerHTML);
        avatarImg.innerHTML = '<img i=\'avatar-img\' >';

        //Устанавливаем источник изображения для аватара
        avatarImg.setAttribute("src", avatarLinkInput);

        //Устанавливаем текст элемента для отредактированного комментария
        editedCommentElement.textContent = wordReplace;
      }

      //Добавляем обработчик события на форму комментрия для вызова функции commentOutput при отправке формы
      commentForm.addEventListener("submit", commentOutput);

      

    
    </script>
  </body>
</html>
